
<html>
<head>
</head>
<body>
<h2> SSE from localhost:8080</h2>
<h3> To make an event,</h3>
<code>curl localhost:8080/makeevent</code>

<div id="list">
</div>

<script>
    const evtSource = new EventSource("http://localhost:8080/sse");
    
    evtSource.onopen = () => {
        console.log("open")
    }
    
    evtSource.onerror = (err) => {
        console.error("EventSource failed:", err);
    };
    
    evtSource.onmessage = (event) => {
        const newElement = document.createElement("li");
        const eventList = document.getElementById("list");
        console.log("message: ");
        console.log(event);
        newElement.textContent = `message: ${event.data}`;
        eventList.appendChild(newElement);
    };
    evtSource.addEventListener("tmp", (e) => {
        const newElement = document.createElement("li");
        const eventList = document.getElementById("list");
        console.log(e.data);
        newElement.textContent = `temp: ${e.data}`;
        eventList.appendChild(newElement);
    });
    
    evtSource.addEventListener("hum", (e) => {
        const newElement = document.createElement("li");
        const eventList = document.getElementById("list");
        console.log(e.data);
        newElement.textContent = `%RH: ${e.data}`;
        eventList.appendChild(newElement);
    });
    
    evtSource.addEventListener("co2", (e) => {
        const newElement = document.createElement("li");
        const eventList = document.getElementById("list");
        console.log(e.data);
        newElement.textContent = `co2: ${e.data}`;
        eventList.appendChild(newElement);
    });
    
</script>
</body>

</html>
